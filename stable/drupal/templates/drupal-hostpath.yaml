{{- if and .Values.persistence.enabled .Values.persistence.drupal.hostPath (not .Values.persistence.drupal.ExistingClaim) -}}
apiVersion: v1
kind: List
items:
  - apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: {{ template "fullname" . }}-hostpath
    spec:
      accessModes:
        - {{ .Values.persistence.drupal.accessMode | quote }}
      capacity:
        storage: {{ .Values.persistence.drupal.size | quote }}
      hostPath:
        path: {{ .Values.persistence.drupal.hostPath | quote }}
  - apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      name: {{ template "fullname" . }}-hostpath
    spec:
      storageClassName: ""
      accessModes:
        - {{ .Values.persistence.drupal.accessMode | quote }}
      resources:
        requests:
          storage: {{ .Values.persistence.drupal.size | quote }}
{{- end -}}

apiVersion: v1
kind: ConfigMap
metadata:
  name: coredns
  namespace: kube-system
data:
  Corefile: |
    .:53 {
        errors
        log stdout
        health
{{- if .Values.metrics.enabled }}
        prometheus localhost:{{ .Values.metrics.port }}
{{- end }}
        kubernetes {{ .Values.clusterDomain }} {
          cidrs {{ .Values.clusterCidr }}
        }
        proxy . /etc/resolv.conf
        cache 30
    }

apiVersion: v1
kind: ConfigMap
metadata:
{{- if .Values.jamadar.configmap.annotations }}
  annotations:
{{ toYaml .Values.jamadar.configmap.annotations | indent 4 }}
{{- end }}
  labels:
{{ include "jamadar.labels.selector" . | indent 4 }}
{{ include "jamadar.labels.chart" . | indent 4 }}
{{- if .Values.jamadar.matchLabels }}
{{ toYaml .Values.jamadar.matchLabels | indent 4 }}
{{- end }}
  name: {{ template "jamadar.name" . }}
data:
  config.yaml: |-
    pollTimeInterval: {{ .Values.jamadar.pollTimeInterval }}
    age: {{ .Values.jamadar.age }}
    resources:
    {{- range .Values.jamadar.resources }}
      - {{ . }}        
    {{- end }}
    actions:
      {{- range .Values.jamadar.actions }}
      - name: {{ .name }}
        params:
        {{- range $key, $value := .params }}
          {{ $key }}: {{ $value }}
        {{- end }}
      {{- end }}    
    restrictedNamespaces:
    {{- range .Values.jamadar.restrictedNamespaces }}
      - {{ . }}        
    {{- end }}

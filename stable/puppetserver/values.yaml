# Default values for puppetserver.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

## Puppet Server Deployment Configuration
##
puppetserver:
  name: puppetserver
  image: puppet/puppetserver
  tag: 6.7.1
  pullPolicy: IfNotPresent
  resources: {}
  #  requests:
  #    memory: 512Mi
  #    cpu: 500m
  #  limits:
  #    memory: 768Mi
  #    cpu: 750m
  ## Fully qualified domain names (FQDN's) to register
  ## the Puppet Server to be internally reachable via DNS.
  ## That is necessary to configure "certname" and "server" in `puppet.conf`.
  ## Required by Puppet server CA CLI application.
  ## "serverName" is mandatory and pre-set to "puppet".
  ## "serverName" variable is going to be made editable when
  ## this bug with the PuppetDB Docker image is resolved.
  ## Gitissue:
  ## "alternateServerNames" is optional.
  ##
  fqdns:
    alternateServerNames: ""   # Comma-separated
  service:
    type: LoadBalancer
    port: 8140
    annotations: {}
    labels: {}
    loadBalancerIP: ""
  ## The pattern of managing Hieradata in a separate repository is
  ## both common and acceptable. Doing so provides the ability to decouple
  ## the management of configuration data from that of the Puppet code base.
  ## A separate Hieradata Repo can be included in the "hiera" section in this file.
  ##
  puppeturl: ""   # git@github.com:$SOMEUSER/puppet.git

## Hiera Data Repo Configuration
##
git_sync:
  name: git_sync
  image: k8s.gcr.io/git-sync
  tag: v3.1.2
  pullPolicy: IfNotPresent
  resources: {}
  #  requests:
  #    memory: 200Mi
  #    cpu: 200m
  #  limits:
  #    memory: 400Mi
  #    cpu: 400m
  branch: ""
  ## Cloning via HTTPS method and its creds (if a private repo)
  ##
  viaHttps:
    enabled: true
    credentials:
      username: ""
      ## The password might be your user-generated token
      ## in case MFA is enabled.
      password: ""
      ## Or set the "username" and "password" from a pre-existing K8s secret
      existingSecret: ""
  ## Cloning via SSH method and its creds
  ##
  viaSsh:
    enabled: false
    credentials:
      ssh:
        ## A multi-line string
        value:  # |
          #  PRIV_KEY CONTENTS
      known_hosts:
        ## A multi-line string
        value:  # |
          #  KNOWN_HOSTS CONTENTS
      ## Or set the git-sync Known Hosts file and SSH Private Key
      ## from a pre-existing K8s secret
      existingSecret: ""

## r10k Repo Configuration
##
r10k:
  name: r10k
  image: puppet/r10k
  tag: 3.3.3
  pullPolicy: IfNotPresent
  resources: {}
  #  requests:
  #    memory: 256Mi
  #    cpu: 250m
  #  limits:
  #    memory: 512Mi
  #    cpu: 500m
  cronJob:
    schedule: "*/2 * * * *"
  ## Cloning via HTTPS method and its creds (if a private repo)
  ##
  viaHttps:
    enabled: true
    credentials:
      username: ""
      ## The password might be your user-generated token
      ## in case MFA is enabled.
      password: ""
      ## Or set the "username" and "password" from a pre-existing K8s secret
      existingSecret: ""
  ## Cloning via SSH method and its creds
  ##
  viaSsh:
    enabled: false
    credentials:
      ssh:
        ## A multi-line string
        value:  # |
          #  PRIV_KEY CONTENTS
      known_hosts:
        ## A multi-line string
        value:  # |
          #  KNOWN_HOSTS CONTENTS
      ## Or set the git-sync Known Hosts file and SSH Private Key
      ## from a pre-existing K8s secret
      existingSecret: ""

## PostgreSQL Configuration for PuppetDB
##
postgres:
  name: postgres
  image: postgres
  tag: 9.6.15
  pullPolicy: IfNotPresent
  resources: {}
  #  requests:
  #    memory: 512Mi
  #    cpu: 500m
  #  limits:
  #    memory: 768Mi
  #    cpu: 750m
  ## "credentials" section is going to be added when
  ## this bug with the PuppetDB Docker image is resolved.
  ## Gitissue:

## PuppetDB Configuration
##
puppetdb:
  name: puppetdb
  image: puppet/puppetdb
  tag: 6.7.2
  pullPolicy: IfNotPresent
  resources: {}
  #  requests:
  #    memory: 512Mi
  #    cpu: 500m
  #  limits:
  #    memory: 768Mi
  #    cpu: 750m
  credentials:
    username: puppetdb
    ## Override the 20-char random "password" in templates/puppetdb-secret.yaml
    password:
      value: ""
      ## Or set the PuppetDB password from a pre-existing K8s secret
      existingSecret: ""
      existingSecretKey: ""

## Puppetboard Configuration
##
puppetboard:
  enabled: false
  name: puppetboard
  image: puppet/puppetboard
  tag: 0.3.0
  pullPolicy: IfNotPresent
  resources: {}
  #  requests:
  #    memory: 368Mi
  #    cpu: 300m
  #  limits:
  #    memory: 768Mi
  #    cpu: 500m

## Hiera Configuration for Puppet Server
##
hiera:
  name: hiera
  hieradataurl: ""   # git@github.com:$SOMEUSER/hieradata.git
  ## If "hiera.config" is set, the pre-filled value of ":eyaml::datadir:",
  ## ":eyaml::pkcs7_private_key:" and ":eyaml::pkcs7_public_key:"
  ## must be kept unchanged.
  ## A multi-line string
  ##
  config:  # |-
  #  :backends:
  #    - eyaml
  #  :hierarchy:
  #    - common
  #  :eyaml:
  #    :datadir: /hiera/git/data   # keep unchanged
  #    :extension: 'yaml'
  #    :pkcs7_private_key: /etc/puppetlabs/puppet/keys/private_key.pkcs7.pem   # keep unchanged
  #    :pkcs7_public_key:  /etc/puppetlabs/puppet/keys/public_key.pkcs7.pem   # keep unchanged
  eyaml:
    ## A multi-line string
    ##
    private_key:  # |
      #  PRIV_KEY CONTENTS
    ## A multi-line string
    ##
    public_key:  # |
      #  PUB_KEY CONTENTS

## Pod Configuration
##
## Node labels for pod assignment
nodeSelector: {}

## Affinity for pod assignment
## Ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity
affinity: {}

## Tolerations for pod assignment
## Ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/
tolerations: []

## Leverage a priorityClass to ensure your pods survive resource shortages
## ref: https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/
# priorityClass: system-cluster-critical

## Extra Pod annotations
podAnnotations: {}

## Storage Configuration
##
storage:
  ## Puppet Server data Persistent Volume Storage Class
  ## If defined, storageClassName: <storageClass>
  ## If set to "-", storageClassName: "", which disables dynamic provisioning
  ## If undefined (the default) or set to null, no storageClassName spec is
  ##   set, choosing the default provisioner.  (gp2 on AWS, standard on
  ##   GKE, AWS & OpenStack)
  ##
  storageClass: ""
  annotations: {}
  size: 100Mi

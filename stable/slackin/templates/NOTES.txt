{{- if not .Values.slack.teamId -}}

ERROR: You did not set a slack.teamId

This deployment will be incomplete until you specify the Slack team id.
Your team id is what you use to access your login page on Slack.

Then run:

    helm upgrade {{ .Release.Name }} --namespace {{ .Release.Namespace }} \
        --set slack.teamId=TEAM-ID-HERE,slack.apiToken=API-KEY-HERE stable/slackin

{{- else if not .Values.slack.apiToken -}}

ERROR: You did not set a slack.apiToken

This deployment will be incomplete until you provide the Slack API token.

You can request an API token at:

    https://api.slack.com/custom-integrations/legacy-tokens

Then run:

    helm upgrade {{ .Release.Name }} --namespace {{ .Release.Namespace }} \
        --set slack.teamId={{ .Values.slack.teamId }},slack.apiToken=API-KEY-HERE stable/slackin

{{- else }}

Your Slackin server can be accessed at http://{{- .Values.ingress.hostname }}

Or access with:

{{- if contains "LoadBalancer" .Values.service.type }}

  It may take a few minutes for the LoadBalancer IP to be available.
  Watch the status with: 'kubectl get svc --namespace {{ .Release.Namespace }} -w {{ template "fullname" . }}'

export SERVICE_IP=$(kubectl get svc --namespace {{ .Release.Namespace }} {{ template "fullname" . }} -o jsonpath='{.status.loadBalancer.ingress[0].ip}')
echo http://$SERVICE_IP
{{- else if contains "ClusterIP"  .Values.service.type }}

  export POD_NAME=$(kubectl get pods --namespace {{ .Release.Namespace }} -l "app={{ template "fullname" . }}" -o jsonpath="{.items[0].metadata.name}")
  echo http://127.0.0.1:8080
  kubectl port-forward $POD_NAME 8080:80
{{- end }}

{{- if contains "NodePort"  .Values.service.type }}

  export NODE_PORT=$(kubectl get --namespace {{ .Release.Namespace }} -o jsonpath="{.spec.ports[0].nodePort}" services {{ template "fullname" . }})
  export NODE_IP=$(kubectl get nodes --namespace {{ .Release.Namespace }} -o jsonpath="{.items[0].status.addresses[0].address}")
  echo http://$NODE_IP:$NODE_PORT
{{- end }}

{{- end }}

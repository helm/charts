{{- $root := . -}}
{{- range .Values.nginx.services }}
---
apiVersion: v1
kind: Service
metadata:
  annotations:
{{ toYaml .annotations | indent 4}}
  labels:
    app: "{{ template "fullname" $root }}"
    chart: "{{ $root.Chart.Name }}-{{ $root.Chart.Version }}"
    component: controller
    heritage: {{ $root.Release.Service }}
    release: {{ $root.Release.Name }}
  name: "{{ template "fullname" $root }}-controller-{{ .name }}"
spec:
  ports:
  - port: 80
    name: http
  - port: 443
    name: https
  selector:
    app: "{{ template "fullname" $root }}"
    component: controller
  type: "{{ .type }}"
{{ end }}

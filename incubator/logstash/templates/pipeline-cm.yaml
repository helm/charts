---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "logstash.fullname" . }}-pipeline
  labels:
    app: {{ template "logstash.name" . }}
    chart: {{ .Chart.Name }}-{{ .Chart.Version | replace "+" "_" }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
data:
  logstash.conf: |-
    input {
      tcp {
        port => 1514
        type => syslog
      }
      udp {
        port => 1514
        type => syslog
      }
      beats {
        port => 5044
      }
    }

    output {
        elasticsearch {
          hosts => ["{{ .Values.elasticsearchHost }}"]
        }
      }
    }
